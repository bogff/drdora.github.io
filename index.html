<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–° –î–Ω—ë–º –†–æ–∂–¥–µ–Ω–∏—è, –î–∞—à–∞ üíñ</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');
body {
  margin: 0;
  height: 100vh;
  font-family: 'Poppins', sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  background:
    linear-gradient(135deg, rgba(255,102,204,0.15), rgba(180,50,230,0.15)),
    url('images/dasha_bg.jpg') no-repeat center center / cover;
  position: relative;
  color: white;
  overflow: hidden;
  backdrop-filter: blur(10px) saturate(180%);
  -webkit-backdrop-filter: blur(10px) saturate(180%);
}

/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
h1 {
  position: absolute;
  top: 10%;
  font-size: 3em;
  text-align: center;
  color: #ff99cc;
  text-shadow: 0 0 10px #ff66cc, 0 0 30px #ff66ff;
  opacity: 0;
  animation: fadeIn 3s forwards;
}

@keyframes fadeIn {
  to {
    opacity: 1;
  }
}

/* –ö–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞ –º—É–∑—ã–∫–∏ */
#playButton {
  padding: 15px 40px;
  font-size: 1.3em;
  border: none;
  border-radius: 25px;
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(12px) saturate(180%);
  -webkit-backdrop-filter: blur(12px) saturate(180%);
  color: #fff;
  cursor: pointer;
  box-shadow: 0 0 20px rgba(255, 102, 204, 0.6);
  transition: 0.3s;
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
}

#playButton:hover {
  transform: translateY(-50%) scale(1.1);
  box-shadow: 0 0 40px rgba(255, 102, 204, 0.9);
}

/* Canvas —ç–∫–≤–∞–ª–∞–π–∑–µ—Ä–∞ */
#equalizer {
  position: absolute;
  bottom: 60px;
  width: 90%;
  max-width: 900px;
  height: 90px;
  border-radius: 20px;
  backdrop-filter: blur(25px) saturate(180%);
  -webkit-backdrop-filter: blur(25px) saturate(180%);
  background: rgba(255, 102, 204, 0.15);
  box-shadow:
    0 0 30px rgba(255, 102, 204, 0.7),
    inset 0 0 15px rgba(255, 182, 193, 0.5);
  overflow: hidden;
}

/* –§–æ—Ç–æ –î–∞—à–∏ */
.photo {
  position: absolute;
  width: 140px;
  height: 140px;
  border-radius: 20px;
  object-fit: cover;
  pointer-events: none;
  transform: translate(-50%, -50%);
  box-shadow: 0 0 20px rgba(255, 102, 204, 0.8),
    0 0 40px rgba(255, 102, 255, 0.5);
  transition: transform 0.3s ease, opacity 0.3s ease;
}

/* Footer */
footer {
  position: absolute;
  bottom: 20px;
  text-align: center;
  font-size: 14px;
  color: #ff99cc;
}
footer a {
  color: #ff66cc;
  text-decoration: none;
  margin: 0 6px;
}
</style>
</head>
<body>
<h1>–° –î–Ω—ë–º –†–æ–∂–¥–µ–Ω–∏—è, –î–∞—à–∞ üéÇüí´</h1>
<button id="playButton">–ù–∞–∂–º–∏, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –º—É–∑—ã–∫—É üéµ</button>
<audio id="bgm" loop>
  <source src="music/papa_temnogo_princa.mp3" type="audio/mpeg" />
</audio>
<div id="equalizer">
  <canvas id="equalizerCanvas"></canvas>
</div>
<footer>
  designed by <b>prostozhenyaaa</b><br />
  <a href="#">Instagram</a> | <a href="#">VK</a> | <a href="#">Telegram</a>
</footer>
<script>
const photos = [
  "images/dasha1.jpg",
  "images/dasha2.jpg",
  "images/dasha3.jpg",
  "images/dasha4.jpg",
];
const equalizerDiv = document.getElementById("equalizer");
const canvas = document.getElementById("equalizerCanvas");
const ctx = canvas.getContext("2d");
const bgm = document.getElementById("bgm");
const playButton = document.getElementById("playButton");

// –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º canvas —Ä–∞–∑–º–µ—Ä –ø–æ–¥ div –∏ DPI
function resizeCanvas() {
  const style = getComputedStyle(equalizerDiv);
  canvas.width = parseInt(style.width) * window.devicePixelRatio;
  canvas.height = parseInt(style.height) * window.devicePixelRatio;
  canvas.style.width = style.width;
  canvas.style.height = style.height;
  ctx.setTransform(1, 0, 0, 1, 0, 0); // —Å–±—Ä–æ—Å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π
  ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

// –°–æ–∑–¥–∞–µ–º –∞—É–¥–∏–æ-–∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä
let audioCtx, source, analyser, dataArray;

function setupAudio() {
  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  source = audioCtx.createMediaElementSource(bgm);
  analyser = audioCtx.createAnalyser();
  analyser.fftSize = 128;
  source.connect(analyser);
  analyser.connect(audioCtx.destination);
  dataArray = new Uint8Array(analyser.frequencyBinCount);
}

// –§—É–Ω–∫—Ü–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –ø–ª–∞–≤–Ω–æ–π –≤–æ–ª–Ω—ã
function drawWave() {
  requestAnimationFrame(drawWave);
  analyser.getByteFrequencyData(dataArray);

  const width = canvas.width / window.devicePixelRatio;
  const height = canvas.height / window.devicePixelRatio;

  ctx.clearRect(0, 0, width, height);

  const pointsCount = dataArray.length;
  const baseY = height * 0.6;
  const waveLength = width / (pointsCount - 1);

  ctx.lineWidth = 6;
  ctx.lineJoin = "round";
  ctx.lineCap = "round";

  // –ì—Ä–∞–¥–∏–µ–Ω—Ç –ª–∏–Ω–∏–∏ –≤–æ–ª–Ω—ã
  const gradientLine = ctx.createLinearGradient(0, 0, width, 0);
  gradientLine.addColorStop(0, "rgba(255, 102, 204, 1)");
  gradientLine.addColorStop(1, "rgba(180, 50, 230, 1)");

  // –ì—Ä–∞–¥–∏–µ–Ω—Ç –∑–∞–ª–∏–≤–∫–∏ –ø–æ–¥ –≤–æ–ª–Ω–æ–π
  const gradientFill = ctx.createLinearGradient(0, 0, 0, height);
  gradientFill.addColorStop(0, "rgba(255, 102, 204, 0.4)");
  gradientFill.addColorStop(1, "rgba(180, 50, 230, 0.05)");

  ctx.strokeStyle = gradientLine;
  ctx.fillStyle = gradientFill;

  ctx.beginPath();

  for (let i = 0; i < pointsCount; i++) {
    const x = i * waveLength;
    const amp = dataArray[i] / 255;

    // –°–ª–æ–∂–Ω–∞—è —Å–∏–Ω—É—Å–æ–∏–¥–∞ —Å —Ä–∞–∑–Ω–æ–π —á–∞—Å—Ç–æ—Ç–æ–π –∏ –∞–º–ø–ª–∏—Ç—É–¥–æ–π
    const y =
      baseY -
      (Math.sin(i * 0.3 + performance.now() / 400) * 20 +
        Math.sin(i * 0.1 + performance.now() / 200) * 15) *
        amp -
      amp * 40;

    if (i === 0) {
      ctx.moveTo(x, y);
    } else {
      ctx.lineTo(x, y);
    }
  }

  // –†–∏—Å—É–µ–º –ª–∏–Ω–∏—é –≤–æ–ª–Ω—ã
  ctx.stroke();

  // –ó–∞–ø–æ–ª–Ω—è–µ–º –æ–±–ª–∞—Å—Ç—å –ø–æ–¥ –≤–æ–ª–Ω–æ–π
  ctx.lineTo(width, height);
  ctx.lineTo(0, height);
  ctx.closePath();
  ctx.fill();
}

// –ê–Ω–∏–º–∞—Ü–∏—è —Ñ–æ—Ç–æ –î–∞—à–∏
function easeOutQuad(t) {
  return t * (2 - t);
}
function easeInQuad(t) {
  return t * t;
}
function spawnPhoto() {
  const photo = document.createElement("img");
  photo.src = photos[Math.floor(Math.random() * photos.length)];
  photo.classList.add("photo");
  photo.style.left = 50 + Math.random() * (window.innerWidth - 100) + "px";
  document.body.appendChild(photo);
  let start = Date.now();
  const duration = 3500 + Math.random() * 2000;
  const startY = -250;
  const endY = window.innerHeight / 2 - 70;
  const maxScale = 1.5 + Math.random() * 0.5;
  function animatePhoto() {
    const now = Date.now();
    const t = (now - start) / duration;
    if (t < 1) {
      const y = startY + (endY - startY) * easeOutQuad(t);
      const scale = 1 + (maxScale - 1) * easeOutQuad(t);
      const rotate = t * 720;
      const opacity = Math.sin(t * Math.PI);
      photo.style.transform = `translate(-50%, ${y}px) scale(${scale}) rotate(${rotate}deg)`;
      photo.style.opacity = opacity;
      requestAnimationFrame(animatePhoto);
    } else {
      start = Date.now();
      const currentScale = maxScale;
      const currentY = endY;
      function returnAnimate() {
        const t2 = (Date.now() - start) / duration;
        if (t2 < 1) {
          const y = currentY - (currentY - startY) * easeInQuad(t2);
          const scale = currentScale - (currentScale - 1) * easeInQuad(t2);
          const rotate = 720 + t2 * 720;
          const opacity = Math.cos((t2 * Math.PI) / 2);
          photo.style.transform = `translate(-50%, ${y}px) scale(${scale}) rotate(${rotate}deg)`;
          photo.style.opacity = opacity;
          requestAnimationFrame(returnAnimate);
        } else {
          photo.remove();
        }
      }
      returnAnimate();
    }
  }
  animatePhoto();
}

// –ó–∞–ø—É—Å–∫ –º—É–∑—ã–∫–∏, —ç–∫–≤–∞–ª–∞–π–∑–µ—Ä–∞ –∏ —Ñ–æ—Ç–æ –ø–æ –∫–Ω–æ–ø–∫–µ
playButton.addEventListener("click", () => {
  if (!audioCtx) setupAudio();
  bgm.play().then(() => {
    drawWave();
    setInterval(spawnPhoto, 1500);
    playButton.style.display = "none";
  });
});
</script>
</body>
</html>
